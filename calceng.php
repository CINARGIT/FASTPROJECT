<?
//ini_set('display_errors', true);
//error_reporting (E_ALL);

$bazcenobsl = array(
	'1' => array( //Этажность
		'1' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 381.6,'5' => 364.6,'6' => 347.4,'7' => 330.0,'8' => 312.8,'9' => 396.0,'10' => 279.6,'11' => 261.8,'12' => 244.4,'13' => 227.6,'14' => 210.4,'15' => 193.4,'16' => 176.2,'17' => 159.2,'18' => 142.2,'19' => 125.2,'20' => 108.6,'21' => 91.2
			),
			'2' => array( //Сложность здания
				'4' => 444.6,'5' => 424.6,'6' => 405.6,'7' => 386.0,'8' => 366.8,'9' => 347.8,'10' => 328.4,'11' => 312.0,'12' => 289.2,'13' => 269.8,'14' => 251.0,'15' => 231.4,'16' => 212.0,'17' => 192.6,'18' => 173.4,'19' => 154.4,'20' => 135.2,'21' => 115.8
			),
			'3' => array( //Сложность здания
				'4' => 496.4,'5' => 475.8,'6' => 455.0,'7' => 433.8,'8' => 412.8,'9' => 392.8,'10' => 371.8,'11' => 350.4,'12' => 329.6,'13' => 308.6,'14' => 287.8,'15' => 267.2,'16' => 246.6,'17' => 225.6,'18' => 204.4,'19' => 183.8,'20' => 163.8,'21' => 142.2
			)
		),
		'2' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 579.8,'5' => 563.2,'6' => 546.4,'7' => 530.2,'8' => 513.6,'9' => 496.8,'10' => 480.2,'11' => 463.6,'12' => 446.6,'13' => 429.8,'14' => 413.0,'15' => 397.2,'16' => 380.6,'17' => 363.6,'18' => 347.2,'19' => 330.6,'20' => 314.2,'21' => 298.0
			),
			'2' => array( //Сложность здания
				'4' => 643.2,'5' => 626.6,'6' => 609.8,'7' => 593.0,'8' => 576.4,'9' => 559.6,'10' => 542.8,'11' => 526.0,'12' => 509.0,'13' => 492.6,'14' => 475.6,'15' => 459.2,'16' => 442.2,'17' => 425.4,'18' => 408.8,'19' => 391.8,'20' => 375.4,'21' => 358.2
			),
			'3' => array( //Сложность здания
				'4' => 715.2,'5' => 699.2,'6' => 682.2,'7' => 665.8,'8' => 649.2,'9' => 632.6,'10' => 616.2,'11' => 600.0,'12' => 583.6,'13' => 566.8,'14' => 550.4,'15' => 534.0,'16' => 517.6,'17' => 501.2,'18' => 485.0,'19' => 468.6,'20' => 452.0,'21' => 436.0
			)
		),
		'3' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 691.6,'5' => 668.4,'6' => 644.6,'7' => 621.0,'8' => 597.8,'9' => 570.6,'10' => 551.0,'11' => 527.8,'12' => 504.4,'13' => 481.2,'14' => 458.0,'15' => 436.2,'16' => 412.0,'17' => 388.6,'18' => 365.2,'19' => 341.8,'20' => 319.0,'21' => 295.6
			),
			'2' => array( //Сложность здания
				'4' => 799.2,'5' => 775.0,'6' => 750.0,'7' => 725.0,'8' => 700.4,'9' => 676.0,'10' => 651.0,'11' => 625.8,'12' => 600.8,'13' => 576.2,'14' => 551.8,'15' => 526.8,'16' => 501.4,'17' => 477.6,'18' => 453.0,'19' => 428.2,'20' => 403.4,'21' => 378.6
			),
			'3' => array( //Сложность здания
				'4' => 910.2,'5' => 883.0,'6' => 855.8,'7' => 829.0,'8' => 801.6,'9' => 774.6,'10' => 747.6,'11' => 720.2,'12' => 693.0,'13' => 666.0,'14' => 639.6,'15' => 611.4,'16' => 584.0,'17' => 556.8,'18' => 529.6,'19' => 502.6,'20' => 475.4,'21' => 452.6
			)
		)
	),
	'2' => array( //Этажность
		'1' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 298.8,'7' => 287.0,'8' => 275.2,'9' => 263.8,'10' => 251.8,'11' => 239.8,'12' => 228.6,'13' => 216.4,'14' => 196.4,'15' => 192.8,'16' => 181.2,'17' => 171.0,'18' => 157.4,'19' => 145.6,'20' => 134.0,'21' => 122.0
			),
			'2' => array( //Сложность здания
				'6' => 338.8,'7' => 325.6,'8' => 312.2,'9' => 298.2,'10' => 285.0,'11' => 271.6,'12' => 258.2,'13' => 244.6,'14' => 230.6,'15' => 217.0,'16' => 203.8,'17' => 190.2,'18' => 176.6,'19' => 163.0,'20' => 149.6,'21' => 136.0
			),
			'3' => array( //Сложность здания
				'6' => 392.4,'7' => 377.0,'8' => 361.0,'9' => 345.4,'10' => 329.4,'11' => 314.2,'12' => 298.4,'13' => 283.0,'14' => 267.0,'15' => 251.2,'16' => 236.0,'17' => 220.2,'18' => 204.8,'19' => 189.0,'20' => 172.8,'21' => 157.4
			)
		),
		'2' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 587.4,'7' => 570.0,'8' => 551.8,'9' => 533.8,'10' => 516.0,'11' => 498.0,'12' => 479.6,'13' => 461.4,'14' => 443.0,'15' => 424.6,'16' => 406.8,'17' => 389.2,'18' => 370.8,'19' => 352.4,'20' => 334.6,'21' => 317.0
			),
			'2' => array( //Сложность здания
				'6' => 659.8,'7' => 641.8,'8' => 623.6,'9' => 604.8,'10' => 587.0,'11' => 568.4,'12' => 550.0,'13' => 532.0,'14' => 513.2,'15' => 495.0,'16' => 476.4,'17' => 458.2,'18' => 440.0,'19' => 421.8,'20' => 403.4,'21' => 386.2
			),
			'3' => array( //Сложность здания
				'6' => 732.0,'7' => 714.4,'8' => 696.4,'9' => 678.4,'10' => 664.2,'11' => 642.2,'12' => 625.2,'13' => 607.6,'14' => 589.6,'15' => 571.8,'16' => 553.8,'17' => 536.2,'18' => 518.0,'19' => 499.8,'20' => 481.2,'21' => 464.4
			)
		),
		'3' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 701.8,'7' => 681.6,'8' => 664.8,'9' => 641.2,'10' => 621.0,'11' => 600.8,'12' => 581.0,'13' => 560.4,'14' => 540.6,'15' => 520.8,'16' => 500.6,'17' => 480.4,'18' => 460.2,'19' => 440.0,'20' => 419.4,'21' => 400.4
			),
			'2' => array( //Сложность здания
				'6' => 780.8,'7' => 760.2,'8' => 739.4,'9' => 717.4,'10' => 698.4,'11' => 677.6,'12' => 657.6,'13' => 637.0,'14' => 618.4,'15' => 596.2,'16' => 575.4,'17' => 555.2,'18' => 534.4,'19' => 514.0,'20' => 493.4,'21' => 473.8
			),
			'3' => array( //Сложность здания
				'6' => 927.8,'7' => 904.4,'8' => 880.6,'9' => 856.8,'10' => 833.4,'11' => 810.4,'12' => 786.8,'13' => 763.6,'14' => 739.8,'15' => 716.8,'16' => 692.6,'17' => 669.8,'18' => 645.8,'19' => 622.2,'20' => 599.0,'21' => 575.8
			)
		)
	)
);

$bazcenobmer = array(
	'1' => array( //Этажность
		'1' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 383.8,'5' => 366.4,'6' => 348.6,'7' => 330.6,'8' => 312.4,'9' => 294.8,'10' => 277.4,'11' => 259.8,'12' => 242,'13' => 223.6,'14' => 205.6,'15' => 188.2,'16' => 170.4,'17' => 152,'18' => 134.2,'19' => 124.8,'20' => 106.6,'21' => 81.4
			),
			'2' => array( //Сложность здания
				'4' => 430.2,'5' => 411,'6' => 392,'7' => 373.4,'8' => 354.8,'9' => 335.4,'10' => 316.6,'11' => 298.2,'12' => 278.6,'13' => 260,'14' => 241,'15' => 222,'16' => 203,'17' => 184,'18' => 164.8,'19' => 146.2,'20' => 127,'21' => 108.6
			),
			'3' => array( //Сложность здания
				'4' => 475,'5' => 455,'6' => 435,'7' => 414.6,'8' => 394.4,'9' => 374,'10' => 354.2,'11' => 334.2,'12' => 314,'13' => 294,'14' => 273.8,'15' => 253.8,'16' => 234,'17' => 213.6,'18' => 193.4,'19' => 173.2,'20' => 153.8,'21' => 133
			)
		),
		'2' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 590,'5' => 565.6,'6' => 541,'7' => 516.6,'8' => 492,'9' => 466.8,'10' => 426.2,'11' => 418,'12' => 394.4,'13' => 368.6,'14' => 343.8,'15' => 319.2,'16' => 294.8,'17' => 270.2,'18' => 245.4,'19' => 220.6,'20' => 195.6,'21' => 171.4
			),
			'2' => array( //Сложность здания
				'4' => 718.6,'5' => 688.8,'6' => 659.2,'7' => 628.4,'8' => 597.8,'9' => 567.4,'10' => 536.8,'11' => 506.2,'12' => 475.6,'13' => 444.4,'14' => 413.6,'15' => 382.8,'16' => 352.8,'17' => 321.8,'18' => 292.2,'19' => 259.2,'20' => 229.6,'21' => 198.8
			),
			'3' => array( //Сложность здания
				'4' => 873.4,'5' => 838.6,'6' => 802,'7' => 765.6,'8' => 728.6,'9' => 694,'10' => 656,'11' => 619.6,'12' => 583.8,'13' => 547.2,'14' => 511,'15' => 474.8,'16' => 438.6,'17' => 401.4,'18' => 364.6,'19' => 328.6,'20' => 292,'21' => 256
			)
		),
		'3' => array( //Сложность работ
			'1' => array( //Сложность здания
				'4' => 711.4,'5' => 684.4,'6' => 657.2,'7' => 629.8,'8' => 602.8,'9' => 575.2,'10' => 547.8,'11' => 512.6,'12' => 485.4,'13' => 458.4,'14' => 431.4,'15' => 403.4,'16' => 376.2,'17' => 349.2,'18' => 322.6,'19' => 294,'20' => 267,'21' => 240
			),
			'2' => array( //Сложность здания
				'4' => 852,'5' => 818,'6' => 784.4,'7' => 750.6,'8' => 717.4,'9' => 683.8,'10' => 649.2,'11' => 614.4,'12' => 580.4,'13' => 546.8,'14' => 504.6,'15' => 470,'16' => 436.8,'17' => 402.6,'18' => 369.2,'19' => 335,'20' => 301.4,'21' => 267.6
			),
			'3' => array( //Сложность здания
				'4' => 946.8,'5' => 909.4,'6' => 873.2,'7' => 837.8,'8' => 801.6,'9' => 765.6,'10' => 729,'11' => 692.8,'12' => 657.2,'13' => 621.4,'14' => 585.8,'15' => 549.8,'16' => 504.8,'17' => 468.6,'18' => 432.6,'19' => 396.1,'20' => 361.4,'21' => 323.6
			)
		)
	),
	'2' => array( //Этажность
		'1' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 409.2,'7' => 389.6,'8' => 369.2,'9' => 349,'10' => 328.6,'11' => 308,'12' => 288,'13' => 268.4,'14' => 243.2,'15' => 227,'16' => 206.6,'17' => 185.2,'18' => 165.4,'19' => 145.6,'20' => 124.8,'21' => 105
			),
			'2' => array( //Сложность здания
				'6' => 465,'7' => 443.2,'8' => 421,'9' => 399.4,'10' => 377.8,'11' => 355.6,'12' => 333.4,'13' => 311.8,'14' => 289.9,'15' => 267.8,'16' => 245.4,'17' => 223.4,'18' => 201.4,'19' => 179.4,'20' => 157,'21' => 105
			),
			'3' => array( //Сложность здания
				'6' => 515.2,'7' => 491,'8' => 468,'9' => 444.8,'10' => 420.8,'11' => 397.8,'12' => 374.4,'13' => 351.6,'14' => 327.8,'15' => 304.2,'16' => 280.6,'17' => 257.2,'18' => 233.6,'19' => 210.2,'20' => 186.4,'21' => 163
			)
		),
		'2' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 661.4,'7' => 634.6,'8' => 608,'9' => 581,'10' => 554.6,'11' => 528,'12' => 500.8,'13' => 473.8,'14' => 446.8,'15' => 419.8,'16' => 393.4,'17' => 361,'18' => 338.4,'19' => 311.2,'20' => 284.2,'21' => 256.6
			),
			'2' => array( //Сложность здания
				'6' => 787.4,'7' => 754.8,'8' => 722.4,'9' => 690.4,'10' => 657.6,'11' => 624.4,'12' => 591,'13' => 558.8,'14' => 526.4,'15' => 493,'16' => 459.4,'17' => 426.6,'18' => 393.4,'19' => 359.8,'20' => 327,'21' => 294.4
			),
			'3' => array( //Сложность здания
				'6' => 916.6,'7' => 879.4,'8' => 842,'9' => 804.2,'10' => 767.4,'11' => 729.4,'12' => 696.4,'13' => 654.2,'14' => 616.4,'15' => 579,'16' => 541.4,'17' => 503,'18' => 466,'19' => 420,'20' => 391.6,'21' => 355.2
			)
		),
		'3' => array( //Сложность работ
			'1' => array( //Сложность здания
				'6' => 771.4,'7' => 742,'8' => 711.8,'9' => 681.2,'10' => 650.6,'11' => 621,'12' => 590,'13' => 559.6,'14' => 529,'15' => 498.6,'16' => 468.2,'17' => 436.8,'18' => 406.4,'19' => 375.2,'20' => 344.6,'21' => 312.4
			),
			'2' => array( //Сложность здания
				'6' => 883.2,'7' => 851.2,'8' => 818.4,'9' => 785.2,'10' => 752.8,'11' => 719.4,'12' => 686,'13' => 653,'14' => 620.2,'15' => 586,'16' => 552.6,'17' => 519.2,'18' => 485.4,'19' => 452.6,'20' => 418.6,'21' => 385.2
			),
			'3' => array( //Сложность здания
				'6' => 962.8,'7' => 929.6,'8' => 895.2,'9' => 861.4,'10' => 828,'11' => 794.2,'12' => 760.6,'13' => 726.8,'14' => 692.4,'15' => 658.4,'16' => 623.6,'17' => 590.2,'18' => 555.6,'19' => 520.6,'20' => 486.6,'21' => 452.6
			)
		)
	)
);

$procentobsl = array(
	'1' => array( //Этажность
		'1' => array( //Каркасность
			'fund' => 0.0434,'sten' => 0.1422,'poly' => 0.0329,'kostki' => 0.1013,'torm' => 0.1665,'nesu' => 0.377,'ogra' => 0.0957,'krov' => 0.041
		),
		'2' => array( //Каркасность
			'fund' => 0.0734,'sten' => 0.325,'poly' => 0.0529,'torm' => 0.035,'nesu' => 0.377,'ogra' => 0.0957,'krov' => 0.041
		)
	),
	'2' => array( //Этажность
		'1' => array( //Каркасность
			'fund' => 0.0384,'sten' => 0.234,'poly' => 0.0645,'kostki' => 0.0919,'lest' => 0.0232,'perek' => 0.342,'sovme' => 0.172,'krov' => 0.034
		),
		'2' => array( //Каркасность
			'fund' => 0.0384,'sten' => 0.3259,'poly' => 0.0645,'lest' => 0.0232,'perek' => 0.342,'sovme' => 0.172,'krov' => 0.034
		)
	)
);

$procentobmer = array(
	'1' => array( //Этажность
		'1' => array( //Каркасность
			'ofunda' => 0.0355,'opoet' => 0.095,'okol' => 0.0337,'opol' => 0.018,'opraz' => 0.0994,'ofafe' => 0.078,'okolst' => 0.0635,'otorm' => 0.0968,'onesu' => 0.1034,'oogr' => 0.0888,'ostrop' => 0.2603,'okrov' => 0.0276
		),
		'2' => array( //Каркасность
			'ofund' => 0.0355,'opoet' => 0.1233,'opol' => 0.028,'opraz' => 0.1394,'ofafe' => 0.098,'opodk' => 0.0335,'onesu' => 0.1358,'oogr' => 0.1037,'ostrop' => 0.2752,'okrov' => 0.0276
		)
	),
	'2' => array( //Этажность
		'1' => array( //Каркасность
			'ofunda' => 0.0284,'opoet' => 0.1438,'okol' => 0.02,'opol' => 0.0312,'opraz' => 0.2134,'ofafe' => 0.1588,'okolst' => 0.0282,'olest' => 0.0298,'operek' => 0.2285,'okrys' => 0.1061,'okrov' => 0.0118
		),
		'2' => array( //Каркасность
			'ofund' => 0.0284,'opoet' => 0.1638,'opol' => 0.0312,'opraz' => 0.2134,'ofafe' => 0.1788,'olest' => 0.0382,'operek' => 0.2285,'okrys' => 0.1059,'okrov' => 0.0118
		)
	)
);



$transhodar = array(0,2,3,4,5,6,7,8,9,10,15);

$dlin = $_POST['dlin'];

$shrin = $_POST['shrin'];

$vyshin = $_POST['vyshin'];

$etage = $_POST['etage'];

$naznage = $_POST['naznage'];

$carcage = $_POST['carcage'];

$caslozhda = $_POST['caslozhda'];

$caslozhra = $_POST['caslozhra'];

$profac = $_POST['profac'];

$infla = $_POST['infla'];

$transhod = $transhodar[$_POST['transhod']] * 1000;

if($_POST['avtopod'] != ''){
	$avtopod = $_POST['avtopod'] * 20000;
}else{
	$avtopod = 0;
}

if($_POST['otschur'] != ''){
	$otschur = $_POST['otschur'] * 20000;
}else{
	$otschur = 0;
}

$preddog = 1.1;

$vobsle = explode(',',$_POST['vobsle']);
array_pop($vobsle);
$procentobsum = 0;

$vobzda = $dlin * $shrin * $vyshin;
$kob = 1;
if($vobzda < 1000){$kob = 4.3;}
elseif(($vobzda >= 1000) AND ($vobzda < 2000)){$kob = 3.5;}
elseif(($vobzda >= 2000) AND ($vobzda < 3000)){$kob = 2.2;}
elseif(($vobzda >= 3000) AND ($vobzda < 4000)){$kob = 1.8;}
elseif(($vobzda >= 4000) AND ($vobzda < 5000)){$kob = 1.3;}
$pvobzda = $vobzda/100;
$pivobzda = $vobzda/1000;

if(($etage == 1) AND ($vyshin < 4)){
	$vyshin = 4;
}
if(($etage == 2) AND ($vyshin < 6)){
	$vyshin = 6;
}
if($vyshin > 21){
	$vyshin = 21;
}
$bazcenob = $bazcenobsl[$etage][$caslozhra][$caslozhda][$vyshin];

foreach ($vobsle as $value){
    $procentobsum = $procentobsum + $procentobsl[$etage][$carcage][$value];
}

if($_POST['vobmer'] != ''){
	$vobmer = explode(',',$_POST['vobmer']);
	array_pop($vobmer);
	$procentobmersum = 0;
	$bazcenom = $bazcenobmer[$etage][$caslozhra][$caslozhda][$vyshin];
	foreach ($vobmer as $value){
		$procentobmersum = $procentobmersum + $procentobmer[$etage][$carcage][$value];
	}
}else{
	$procentobmersum = 0;
	$bazcenom = 0;
}

$inzhtab = array(
	'gorvo' => array( //Горячеее водоснабжение
		'1' => 0.6,'2' => 0.9,'4' => 1,'8' => 2.2,'12' => 2.8,'16' => 3.5,'24' => 4.3,'32' => 5.1,'40' => 5.6
	),
	'otop' => array( //Отопление
		'1' => 0.9,'3' => 1.5,'5' => 2.5,'10' => 3.3,'15' => 4.0,'20' => 4.9
	),
	'holvo' => array( //Холодное водоснабжение и канализация
		'1' => 0.7,'2' => 1,'4' => 1.4,'8' => 2.4,'12' => 3.1,'16' => 3.9,'24' => 4.8,'32' => 5.7,'40' => 6.2
	),
	'venti' => array( //Вентиляция
		'1' => 1,'3' => 2.2,'5' => 3.5,'10' => 4.4,'15' => 5.2,'20' => 6.6
	),
	'musou' => array( //Мусороудаление
		'1' => 1,'3' => 2.2,'5' => 3.5,'10' => 4.4,'15' => 5.2,'20' => 6.6
	),
	'gaszn' => array( //Газоснабжение
		'1' => 0.6,'2' => 0.8,'4' => 1.1,'8' => 1.9,'12' => 2.5,'16' => 3.1,'24' => 3.8,'32' => 4.6,'40' => 5.0
	),
	'vosto' => array( //Водостоки
		'1' => 0.4,'3' => 0.9,'5' => 1.5,'10' => 1.9,'15' => 2.2,'20' => 2.7
	)
);

if($_POST['vinzh'] != ''){
	$vinzh = explode(',',$_POST['vinzh']);
	array_pop($vinzh);
	$svinzh = 0;
	$inzhotval = array('gorvo' => 0.2,'otop' => 0.7,'holvo' => 0.3,'venti' => 1.1,'musou' => 1.1,'gaszn' => 0.2,'vosto' => 0.5);
	$funtar = array('otop','venti','musou');
	foreach ($vinzh as $key => $value){
		if($value != 'elses'){
			foreach ($inzhtab[$value] as $kkey => $walue){
				if($kkey < $pivobzda){
					$tval = $kkey;
				}
			}
			$otval = ($pivobzda - $tval) * $inzhotval[$value];
			if(in_array($value,$funtar)){
				$otval = $otval / 5;
			}
			$vinzh[$key] = $inzhtab[$value][$tval] + $otval;
		}else{
			$vinzh[$key] = $dlin * $shrin * 0.0012;
		}
		$svinzh = $svinzh + $vinzh[$key];
	}
	$svinzh = $svinzh * 1200; //скрытая прокладка
}else{
	$svinzh = 0;
}

$uslofacoef = 1;
if($_POST['uslofac'] != ''){
	$fuslofac = array('prosad' => 1.2, 'dejpro' => 1.15, 'www' => 1.2, 'zim' => 1.2, 'pamarch' => 1.25, 'vysrab' => 1.15, 'slagr' => 1.2, 'sregr' => 1.3, 'silagr' => 1.4, 'usicon' => 1.2, 'seis7' => 1.1, 'seis8' => 1.2, 'specre' => 1.25 );
	$uslofac = explode(',',$_POST['uslofac']);
	array_pop($uslofac);
	foreach ($uslofac as $value){
		$uslofacoef = $uslofacoef * $fuslofac[$value];
	}
}
//var_dump($vinzh);

$summ = (($bazcenob * $procentobsum + $bazcenom * $procentobmersum) * $pvobzda * $kob * $naznage * $profac + $svinzh)* $uslofacoef * $preddog * $infla + $avtopod + $otschur + $transhod;

$summ15 = $summ * 1.15;

$summ = number_format(round($summ), 0, ',', ' ');

$summ15 = number_format(round($summ15), 0, ',', ' ');

echo str_replace(' ','&nbsp;',$summ.' – '.$summ15);

?>